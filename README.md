# 骁流 (Flow State)

**骁流 (Flow State)** 是一款旨在帮助用户维持专注、进入“心流”状态的桌面应用程序。它通过智能监测用户的活动状态，结合 AI 分析屏幕内容，提供实时的状态反馈、疲劳提醒以及详细的数据统计，帮助用户平衡工作与休息，提升效率。

## ✨ 核心功能

*   **全自动状态监测**: 自动识别并记录当前状态为“工作”、“娱乐”或“休息/离开”。
*   **AI 智能分析**: 集成 LangFlow (配合 Ollama 等本地模型)，智能分析当前窗口内容，精准分类活动类型（如“查阅技术文档”、“在线购物”等）。
*   **双模式切换**:
    *   **💪 专注模式**: 专注于工作，当检测到长时间娱乐或疲劳时触发提醒。
    *   **🔋 充能模式**: 专注于休息与恢复，暂停工作相关的严格监督。
*   **健康提醒**:
    *   **疲劳提醒**: 当连续专注时长超过设定阈值（支持自定义及关闭）时，温馨提醒休息。
    *   **娱乐限时**: 在专注模式下，若检测到长时间沉浸于娱乐活动，将触发提醒。
*   **数据可视化**: 提供每日专注报告、时间轴回顾及效率分析。
*   **隐私安全**: 所有数据采集与分析均在本地进行（依赖本地部署的 AI 服务），保障用户隐私。

## 🛠️ 安装说明

### 1. 环境要求
*   Windows 操作系统
*   Python 3.8+
*   [LangFlow](https://github.com/langflow-ai/langflow) (用于运行 AI 业务流)

### 2. 安装依赖
克隆项目到本地后，在项目根目录下运行：

```bash
pip install -r requirements.txt
```

### 3. 配置 AI 服务 (LangFlow)
本项目依赖本地运行的 LangFlow 服务来进行智能分析。

1.  安装并启动 LangFlow:
    ```bash
    pip install langflow
    python -m langflow run
    ```
2.  导入 AI 流程:
    *   在 LangFlow 界面中，导入 `app/service/ai/flow_Json/` 目录下的 JSON 流程文件（例如 `New Flow.json`）。
    *   确保流程中的模型节点（如 Ollama）已正确配置并能够连接到您的本地模型（建议使用 `qwen2.5` 或 `llama3`）。
3.  配置 API 端点 (可选):
    *   默认配置下，程序会连接 `http://localhost:7860`。
    *   如需修改，请在环境变量中设置 `LANGFLOW_DETECT_URL` 等参数，或修改 `app/service/ai/langflow_client.py`。

## 🚀 使用指南

1.  **启动应用**:
    在项目根目录下运行：
    ```bash
    python run.py
    ```

2.  **桌面悬浮球**:
    *   启动后，桌面会出现一个悬浮球，实时显示当前的专注/休息状态。
    *   **鼠标悬停**: 呼出详细状态卡片。
    *   **单击**: 切换卡片显示/隐藏。

3.  **状态卡片**:
    *   查看今日专注时长、连续专注时间。
    *   **模式切换**: 点击“专注模式”或“充能模式”进行切换。
    *   **疲劳阈值**: 在下拉菜单中选择疲劳提醒的时间阈值（15/30/45分钟），或选择“无”关闭提醒。
    *   **高级模式**: 查看更多统计数据。

4.  **每日报告**:
    *   程序运行期间会自动记录数据，支持生成每日专注度报告，帮助复盘当日工作状态。

## 📂 项目结构

详见 [PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md) 文档。

```text
c:/心境项目/flow_state/
├── app/                  # 主应用程序核心代码
│   ├── data/             # 数据层 (DAO, 数据库, 清洗逻辑)
│   ├── service/          # 业务层 (监控, AI, API)
│   ├── ui/               # 界面层 (PySide6 组件)
│   └── web/              # 本地 Web 看板
├── run.py                # 启动入口
└── ...
```

## 📝 许可证

[MIT License](LICENSE)
